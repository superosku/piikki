machine:
  node:
    version: 6.5.0
  python:
    version: 3.5.1
  services:
     - postgresql
  environment:
    TEST_DATABASE_URL: postgres://127.0.0.1:5432/circle_test
    SECRET_KEY: super-secret
    FLASK_APP: autoapp.py

dependencies:
  override:
     - pip install -r requirements.txt
     - npm install
     - ./node_modules/webpack/bin/webpack.js
#     - ./node_modules/selenium-standalone/bin/selenium-standalone install

test:
  pre:
    - flask threaded:
       background: true
#    - ./node_modules/selenium-standalone/bin/selenium-standalone start
#        background true

  override:
    - py.test
    - ./node_modules/nightwatch/bin/nightwatch
